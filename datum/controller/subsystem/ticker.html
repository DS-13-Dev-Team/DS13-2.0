<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <base href="../../../" />
    <link rel="stylesheet" href="dmdoc.css" />
    <title>&#x2F;datum&#x2F;controller&#x2F;subsystem&#x2F;ticker - Daedalus Dock</title>
</head>
<body>
<header>
    <a href="index.html">Daedalus Dock</a> -
    <a href="index.html#modules">Modules</a> -
    <a href="index.html#types">Types</a>
 &mdash; <a href="datum/controller/subsystem/ticker.html#var">Var Details</a> - <a href="datum/controller/subsystem/ticker.html#proc">Proc Details</a></header>
<main>
<h1>ticker <aside>/<a href="datum.html">datum</a>/<a href="datum/controller/subsystem.html">controller/subsystem</a>/<a href="datum/controller/subsystem/ticker.html">ticker</a></aside>
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L3">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 3"/></a></h1>

<table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/credits_music">credits_music</a></th><td>Media track for the round end music.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/emergency_reason">emergency_reason</a></th><td>Why an emergency shuttle was called</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/force_ending">force_ending</a></th><td>When TRUE, the round will end next tick or has already ended. Use SSticker.end_round() instead. This var is used by non-gamemodes to end the round.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/hearts">hearts</a></th><td>People who have been commended and will receive a heart</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/login_music">login_music</a></th><td>Media track for the music played in the lobby</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/mode_display_name">mode_display_name</a></th><td>The name of the gamemode to show at roundstart. This is here to admins can give fake gamemodes.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/player_ready_data">player_ready_data</a></th><td>Data for lobby player stat panels during the pre-game.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/popcount">popcount</a></th><td>Round end statistics of the population</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/ready_players">ready_players</a></th><td>All players that are readied up and about to spawn in.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/totalPlayers">totalPlayers</a></th><td>Num of players, used for pregame stats on statpanel</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/totalPlayersReady">totalPlayersReady</a></th><td>Num of ready players, used for pregame stats on statpanel (only viewable by admins)</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#var/total_admins_ready">total_admins_ready</a></th><td>Num of ready admins, used for pregame stats on statpanel (only viewable by admins)</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/HandleRandomHardcoreScore">HandleRandomHardcoreScore</a></th><td>Handles random hardcore point rewarding if it applies.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/antag_report">antag_report</a></th><td>gotta escape nerd</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/award_service">award_service</a></th><td>Awards the service department an achievement and updates the chef and bartender's highscore for tourists served.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/choose_round_end_song">choose_round_end_song</a></th><td>The reference to the end of round sound that we have chosen.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/declare_completion">declare_completion</a></th><td>no score no glory</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/draft_gamemodes">draft_gamemodes</a></th><td>Generate a list of gamemodes we can play.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/filter_headless_departments">filter_headless_departments</a></th><td>Removes departments with a head present from the given list, returning the values as bitflags</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/get_random_spawnpoint">get_random_spawnpoint</a></th><td>Returns a (probably) unused latejoin spawn point. Used by roundstart code to spread players out.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/handle_hearts">handle_hearts</a></th><td>Once the round is actually over, cycle through the ckeys in the hearts list and give them the hearted status</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/hardcore_random_report">hardcore_random_report</a></th><td>Generate a report for all players who made it out alive with a hardcore random character and prints their final score</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/log_roundend_report">log_roundend_report</a></th><td>Log the round-end report as an HTML file</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/marker_report">marker_report</a></th><td>total service income
This is the richest account on station at roundend.
This is the station's total wealth at the end of the round.
How many players joined the round.
Generate a report for necromorph markers.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/market_report">market_report</a></th><td>Generate a report for how much money is on station, as well as the richest crewmember on the station.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/pick_credits_music">pick_credits_music</a></th><td>The full path of the last song used
The full datum of the last song used.</td></tr>
            <tr><th><a href="datum/controller/subsystem/ticker.html#proc/poll_hearts">poll_hearts</a></th><td>Called when the shuttle starts launching back to centcom, polls a few random players who joined the round for commendations</td></tr></table>
    <h2 id="var">Var Details</h2><h3 id="var/credits_music"><aside class="declaration">var </aside>credits_music
            <aside>&ndash; /<a href="datum.html">datum</a>/<a href="datum/media.html">media</a></aside>
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L34">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 34"/></a></h3>
        <p>Media track for the round end music.</p><h3 id="var/emergency_reason"><aside class="declaration">var </aside>emergency_reason
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L86">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 86"/></a></h3>
        <p>Why an emergency shuttle was called</p><h3 id="var/force_ending"><aside class="declaration">var </aside>force_ending
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L14">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 14"/></a></h3>
        <p>When TRUE, the round will end next tick or has already ended. Use SSticker.end_round() instead. This var is used by non-gamemodes to end the round.</p><h3 id="var/hearts"><aside class="declaration">var </aside>hearts
            <aside>&ndash; /list</aside>
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L81">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 81"/></a></h3>
        <p>People who have been commended and will receive a heart</p><h3 id="var/login_music"><aside class="declaration">var </aside>login_music
            <aside>&ndash; /<a href="datum.html">datum</a>/<a href="datum/media.html">media</a></aside>
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L32">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 32"/></a></h3>
        <p>Media track for the music played in the lobby</p><h3 id="var/mode_display_name"><aside class="declaration">var </aside>mode_display_name
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L26">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 26"/></a></h3>
        <p>The name of the gamemode to show at roundstart. This is here to admins can give fake gamemodes.</p><h3 id="var/player_ready_data"><aside class="declaration">var </aside>player_ready_data
            <aside>&ndash; /list</aside>
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L61">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 61"/></a></h3>
        <p>Data for lobby player stat panels during the pre-game.</p><h3 id="var/popcount"><aside class="declaration">var </aside>popcount
            <aside>&ndash; /list</aside>
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L68">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 68"/></a></h3>
        <p>Round end statistics of the population</p><h3 id="var/ready_players"><aside class="declaration">var </aside>ready_players
            <aside>&ndash; /list/mob/dead/new_player</aside>
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L29">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 29"/></a></h3>
        <p>All players that are readied up and about to spawn in.</p><h3 id="var/totalPlayers"><aside class="declaration">var </aside>totalPlayers
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L55">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 55"/></a></h3>
        <p>Num of players, used for pregame stats on statpanel</p><h3 id="var/totalPlayersReady"><aside class="declaration">var </aside>totalPlayersReady
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L57">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 57"/></a></h3>
        <p>Num of ready players, used for pregame stats on statpanel (only viewable by admins)</p><h3 id="var/total_admins_ready"><aside class="declaration">var </aside>total_admins_ready
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L59">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 59"/></a></h3>
        <p>Num of ready admins, used for pregame stats on statpanel (only viewable by admins)</p><h2 id="proc">Proc Details</h2><h3 id="proc/HandleRandomHardcoreScore"><aside class="declaration">proc </aside>HandleRandomHardcoreScore<aside>(/<a href="client.html">client</a>/player_client) 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/__HELPERS/roundend.dm#L196">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 196"/></a></aside>
        </h3>
        <p>Handles random hardcore point rewarding if it applies.</p><h3 id="proc/antag_report"><aside class="declaration">proc </aside>antag_report<aside>() 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/__HELPERS/roundend.dm#L624">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 624"/></a></aside>
        </h3>
        <p>gotta escape nerd</p><h3 id="proc/award_service"><aside class="declaration">proc </aside>award_service<aside>(award) 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/__HELPERS/roundend.dm#L584">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 584"/></a></aside>
        </h3>
        <p>Awards the service department an achievement and updates the chef and bartender's highscore for tourists served.</p>
<p>Arguments:</p>
<ul>
<li>award: Achievement to give service department</li>
</ul><h3 id="proc/choose_round_end_song"><aside class="declaration">proc </aside>choose_round_end_song<aside>() 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L703">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 703"/></a></aside>
        </h3>
        <p>The reference to the end of round sound that we have chosen.</p><h3 id="proc/declare_completion"><aside class="declaration">proc </aside>declare_completion<aside>() 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/__HELPERS/roundend.dm#L216">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 216"/></a></aside>
        </h3>
        <p>no score no glory</p><h3 id="proc/draft_gamemodes"><aside class="declaration">proc </aside>draft_gamemodes<aside>() 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L783">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 783"/></a></aside>
        </h3>
        <p>Generate a list of gamemodes we can play.</p><h3 id="proc/filter_headless_departments"><aside class="declaration">proc </aside>filter_headless_departments<aside>(/list/departments) 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L463">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 463"/></a></aside>
        </h3>
        <p>Removes departments with a head present from the given list, returning the values as bitflags</p><h3 id="proc/get_random_spawnpoint"><aside class="declaration">proc </aside>get_random_spawnpoint<aside>() 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L384">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 384"/></a></aside>
        </h3>
        <p>Returns a (probably) unused latejoin spawn point. Used by roundstart code to spread players out.</p><h3 id="proc/handle_hearts"><aside class="declaration">proc </aside>handle_hearts<aside>() 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/__HELPERS/hearted.dm#L27">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;hearted.dm 27"/></a></aside>
        </h3>
        <p>Once the round is actually over, cycle through the ckeys in the hearts list and give them the hearted status</p><h3 id="proc/hardcore_random_report"><aside class="declaration">proc </aside>hardcore_random_report<aside>() 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/__HELPERS/roundend.dm#L604">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 604"/></a></aside>
        </h3>
        <p>Generate a report for all players who made it out alive with a hardcore random character and prints their final score</p><h3 id="proc/log_roundend_report"><aside class="declaration">proc </aside>log_roundend_report<aside>() 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/__HELPERS/roundend.dm#L386">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 386"/></a></aside>
        </h3>
        <p>Log the round-end report as an HTML file</p>
<p>Composits the roundend report, and saves it in two locations.
The report is first saved along with the round's logs
Then, the report is copied to a fixed directory specifically for
housing the server's last roundend report. In this location,
the file will be overwritten at the end of each shift.</p><h3 id="proc/marker_report"><aside class="declaration">proc </aside>marker_report<aside>() 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/__HELPERS/roundend.dm#L559">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 559"/></a></aside>
        </h3>
        <p>total service income
This is the richest account on station at roundend.
This is the station's total wealth at the end of the round.
How many players joined the round.
Generate a report for necromorph markers.</p><h3 id="proc/market_report"><aside class="declaration">proc </aside>market_report<aside>() 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/__HELPERS/roundend.dm#L507">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;roundend.dm 507"/></a></aside>
        </h3>
        <p>Generate a report for how much money is on station, as well as the richest crewmember on the station.</p><h3 id="proc/pick_credits_music"><aside class="declaration">proc </aside>pick_credits_music<aside>() 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/controllers/subsystem/ticker.dm#L768">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;ticker.dm 768"/></a></aside>
        </h3>
        <p>The full path of the last song used
The full datum of the last song used.</p><h3 id="proc/poll_hearts"><aside class="declaration">proc </aside>poll_hearts<aside>() 
        
    
            <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/blob/975a092fc82ece05c3fb57ce413da5c0a807f55f/code/__HELPERS/hearted.dm#L2">
        <img src="git.png" width="16" height="16" title="code&#x2F;__HELPERS&#x2F;hearted.dm 2"/></a></aside>
        </h3>
        <p>Called when the shuttle starts launching back to centcom, polls a few random players who joined the round for commendations</p></main>
<footer>
    daedalus.dme
    <a href="https://github.com/DS-13-Dev-Team/DS13-2.0/tree/975a092fc82ece05c3fb57ce413da5c0a807f55f">975a092</a>
        (master) &mdash; <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.8.0</a></footer>
</body>
</html>
